<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IIBSE | School Affiliation</title>

    <style>
        body { margin:0; font-family: Arial; background:#f4f4f4; }
        header { background:#002b5b; color:white; padding:20px; text-align:center; }
        nav { background:#014f86; padding:10px; text-align:center; }
        nav a { color:white; margin:12px; text-decoration:none; }
        nav a:hover { border-bottom:2px solid white; }
        .container {
            max-width:600px; margin:auto; background:white; padding:25px; 
            margin-top:25px; border-radius:10px;
            box-shadow:0 0 10px rgba(0,0,0,0.1);
        }
        input, textarea {
            width:100%; padding:12px; margin:10px 0; border-radius:6px;
            border:1px solid #bbb; font-size:15px;
        }
        button {
            width:100%; padding:12px; background:#014f86; border:none;
            border-radius:6px; color:white; font-size:16px; cursor:pointer;
        }
        button:hover { background:#002b5b; }
        #response { margin-top:15px; padding:12px; background:#eef1ff; border-radius:6px; }
        footer {
            background:#002b5b; color:white; padding:15px; text-align:center;
            margin-top:40px;
        }
    </style>
</head>

<body>

<header>
    <h1>School Affiliation</h1>
    <p>Apply Online for IIBSE Affiliation</p>
</header>

<nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="affiliation.html">Affiliation</a>
    <a href="courses.html">Courses</a>
    <a href="examination.html">Examination</a>
    <a href="verification.html">Verification</a>
    <a href="contact.html">Contact</a>
</nav>

<div class="container">

    <h2>Apply for Affiliation</h2>
    <p>Fill the form below to get your school affiliated with IIBSE.</p>

    <input id="school_name" placeholder="School Name" />
    <input id="registration_no" placeholder="School Registration Number" />
    <input id="principal_name" placeholder="Principal Name" />
    <input id="email" type="email" placeholder="Official Email" />
    <input id="phone" placeholder="Phone Number" />
    <textarea id="address" placeholder="Full Address"></textarea>
    <input id="city" placeholder="City" />
    <input id="state" placeholder="State" />
    <input id="pincode" placeholder="Pincode" />

    <button onclick="submitAffiliation()">Submit Application</button>

    <div id="response"></div>
</div>

<footer>
    ¬© 2025 IIBSE | India International Board of Skills & Education
</footer>

<script>
async function submitAffiliation() {

    const data = {
        school_name: school_name.value.trim(),
        registration_no: registration_no.value.trim(),
        principal_name: principal_name.value.trim(),
        email: email.value.trim(),
        phone: phone.value.trim(),
        address: address.value.trim(),
        city: city.value.trim(),
        state: state.value.trim(),
        pincode: pincode.value.trim()
    };

    // Basic validation
    if (!data.school_name || !data.registration_no || !data.principal_name ||
        !data.email || !data.phone || !data.address || !data.city || !data.state || !data.pincode) {
        document.getElementById("response").innerHTML =
        `<p style="color:red">‚ùå All fields are required.</p>`;
        return;
    }

    try {
        const res = await fetch("https://iibse-backend.onrender.com/api/schools/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await res.json();

        if (!res.ok || result.error) {
            document.getElementById("response").innerHTML =
                `<p style='color:red'>‚ùå ${result.error || "Submission failed"}</p>`;
        } else {
            document.getElementById("response").innerHTML =
                `<p style='color:green'>‚úî Application Submitted Successfully!  
                 <br>Our team will contact you soon.</p>`;

            // Clear form
            school_name.value = "";
            registration_no.value = "";
            principal_name.value = "";
            email.value = "";
            phone.value = "";
            address.value = "";
            city.value = "";
            state.value = "";
            pincode.value = "";
        }
    } catch (error) {
        document.getElementById("response").innerHTML =
            `<p style='color:red'>‚ùå Network Error. Try again.</p>`;
    }
}
</script>
<script>
// üîó Backend API URL
const API_BASE = "https://iibse-backend.onrender.com";

// üìå School Registration Submit Function
async function submitSchoolForm() {
    const school_name = document.getElementById("school_name").value;
    const registration_no = document.getElementById("registration_no").value;
    const principal_name = document.getElementById("principal_name").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    const address = document.getElementById("address").value;
    const city = document.getElementById("city").value;
    const state = document.getElementById("state").value;
    const pincode = document.getElementById("pincode").value;

    const body = {
        school_name,
        registration_no,
        principal_name,
        email,
        phone,
        address,
        city,
        state,
        pincode
    };

    const res = await fetch(`${API_BASE}/api/schools/register`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
    });

    const data = await res.json();

    if (data.error) {
        alert("‚ùå ERROR: " + data.error);
    } else {
        alert("‚úÖ School Registered Successfully!");
    }
}
</script>
</body>
</html>
