<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IIBSE | School Affiliation</title>

    <style>
        body { margin:0; font-family: Arial; background:#f4f4f4; }
        header { background:#002b5b; color:white; padding:20px; text-align:center; }
        nav { background:#014f86; padding:10px; text-align:center; }
        nav a { color:white; margin:12px; text-decoration:none; }
        nav a:hover { border-bottom:2px solid white; }
        .container {
            max-width:600px; margin:auto; background:white; padding:25px; 
            margin-top:25px; border-radius:10px;
            box-shadow:0 0 10px rgba(0,0,0,0.1);
        }
        input, textarea {
            width:100%; padding:12px; margin:10px 0; border-radius:6px;
            border:1px solid #bbb; font-size:15px;
        }
        button {
            width:100%; padding:12px; background:#014f86; border:none;
            border-radius:6px; color:white; font-size:16px; cursor:pointer;
        }
        button:hover { background:#002b5b; }
        #response { margin-top:15px; padding:12px; background:#eef1ff; border-radius:6px; }
        footer {
            background:#002b5b; color:white; padding:15px; text-align:center;
            margin-top:40px;
        }
    </style>
</head>

<body>

<header>
    <h1>School Affiliation</h1>
    <p>Apply Online for IIBSE Affiliation</p>
</header>

<nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="affiliation.html">Affiliation</a>
    <a href="courses.html">Courses</a>
    <a href="examination.html">Examination</a>
    <a href="verification.html">Verification</a>
    <a href="contact.html">Contact</a>
</nav>

<div class="container">

    <h2>Apply for Affiliation</h2>
    <p>Fill the form below to get your school affiliated with IIBSE.</p>

    <input id="school_name" placeholder="School / Institute Name" />
    <input id="principal_name" placeholder="Owner / Principal Name" />
    <input id="email" type="email" placeholder="Official Email" />
    <input id="phone" placeholder="Phone Number" />
    <textarea id="address" placeholder="Full Address"></textarea>
    <input id="city" placeholder="District / City" />

    <button onclick="submitAffiliation()">Submit Application</button>

    <div id="response"></div>
</div>

<footer>
    © 2025 IIBSE | India International Board of Skills & Education
</footer>

<!-- FINAL WORKING AFFILIATION JS -->
<script>
async function submitAffiliation() {
    const data = {
        institute_name: document.getElementById("school_name").value.trim(),
        owner_name: document.getElementById("principal_name").value.trim(),
        email: document.getElementById("email").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        address: document.getElementById("address").value.trim(),
        district: document.getElementById("city").value.trim(),
        document_url: "N/A"
    };

    if (!data.institute_name || !data.owner_name || !data.email || !data.phone || !data.address || !data.district) {
        document.getElementById("response").innerHTML =
        `<p style="color:red">❌ All fields are required.</p>`;
        return;
    }

    try {
        const res = await fetch("https://iibse-backend.onrender.com/affiliation", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
        });

        const result = await res.json();

        if (result.success) {
            document.getElementById("response").innerHTML =
            `<p style='color:green'>✔ Application Submitted Successfully!  
            <br>Our team will contact you soon.</p>`;

            // CLEAR FORM
            document.getElementById("school_name").value = "";
            document.getElementById("principal_name").value = "";
            document.getElementById("email").value = "";
            document.getElementById("phone").value = "";
            document.getElementById("address").value = "";
            document.getElementById("city").value = "";
        } 
        else {
            document.getElementById("response").innerHTML =
            `<p style='color:red'>❌ Submission failed.</p>`;
        }

    } catch (err) {
        document.getElementById("response").innerHTML =
        `<p style='color:red'>❌ Server Error. Try again.</p>`;
    }
}
</script>

</body>
</html>
